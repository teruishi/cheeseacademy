(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{1424:function(e,t,r){"use strict";var n=r(0),o=(r(15),r(10),r(11),r(58),r(21)),c=r(188),d=r(30),l=r(106),h=r(573),_={mixins:[d.a],computed:{$_purchaseable_actionType(){return this.$store.state.modal.purchaseModalContainer.actionType},$_purchaseable_note(){return this.$store.state.purchase.note},$_purchaseable_magazine(){return this.$store.state.purchase.magazine},$_purchaseable_creator(){return this.$store.state.purchase.creator},$_purchaseable_contentAuthor(){return"note_purchase"===this.$_purchaseable_actionType||"support"===this.$_purchaseable_actionType?this.$_purchaseable_note.user:this.$_purchaseable_magazine.user},$_purchaseable_contentPrice(){return"note_purchase"===this.$_purchaseable_actionType?this.$_purchaseable_note.price:this.$_purchaseable_magazine.price},$_purchaseable_withSupport(){return this.$store.state.modal.purchaseModalContainer.withSupport},$_purchaseable_supportPrice(){return this.$store.state.modal.purchaseModalContainer.supportPrice},$_purchaseable_supportMessage(){return Object(l.stripTags)(this.$store.state.modal.purchaseModalContainer.supportMessage)},$_purchaseable_paymentMethod(){return this.$store.state.modal.purchaseModalContainer.paymentMethod||this.currentUser.lastPaymentMethod},$_purchaseable_shouldShowCautionModal(){return"note_purchase"===this.$_purchaseable_actionType&&!0!==this.$_purchaseable_note.isRefund&&this.$_purchaseable_note.price>=5e3},$_purchaseable_isMoveToPurchasePage(){return Object(h.b)(this.isLoggedIn,this.$path)}},methods:Object.assign(Object.assign({},d.a.methods),{openPurchaseModal(e,content,t,r){var c=arguments,d=this;return Object(n.a)((function*(){var n=c.length>4&&void 0!==c[4]?c[4]:"";if(d.$webview.isAndroidWebview)window.location.href=d.$webview.purchaseUrlAndroid(e,content);else switch(yield d.$store.dispatch(o.USER_ACTION_TYPES.AUTH),e){case"note":d.$_purchaseable_openPurchaseNoteModal(content,n);break;case"magazine":d.$_purchaseable_openPurchaseMagazineModal(content);break;case"support":d.$_purchaseable_openPurchaseSupportModal(content);break;case"magazine_subscribe":d.$_purchaseable_openPurchaseSubscribeMagazine(content,t,r);break;case"premium_subscribe":d.$_purchaseable_openPurchaseSubscribePremium(content);break;default:throw new Error("Unable to open due to unexpected kind")}}))()},$_purchaseable_purchase(e){var t=this;return Object(n.a)((function*(){var{returnUrl:r}=e;switch(t.$_purchaseable_actionType){case"support":yield t.$store.dispatch(c.PURCHASE_ACTION_TYPES.PURCHASE_SUPPORT,{creator:t.$_purchaseable_creator,price:t.$_purchaseable_supportPrice,message:t.$_purchaseable_supportMessage,paymentMethod:t.$_purchaseable_paymentMethod,contentType:"Note",contentId:t.$_purchaseable_note.id,contentKey:t.$_purchaseable_note.key,returnUrl:r||location.href});break;case"note_purchase":case"magazine_purchase":var n;t.$_purchaseable_withSupport&&((n={}).price=t.$_purchaseable_supportPrice,n.message=t.$_purchaseable_supportMessage),r||(r=location.href),"note_purchase"===t.actionType?yield t.$store.dispatch(c.PURCHASE_ACTION_TYPES.PURCHASE_NOTE,{note:t.note,paymentMethod:t.$_purchaseable_paymentMethod,support:n,returnUrl:r}):yield t.$store.dispatch(c.PURCHASE_ACTION_TYPES.PURCHASE_MAGAZINE,{paymentMethod:t.$_purchaseable_paymentMethod,support:n,returnUrl:r})}t.$store.dispatch(o.USER_ACTION_TYPES.RESET_CREDITCARD);var d=t.$store.state.purchase.errored;d?t.apiError=d:t.$emit("afterPurchase",{paymentMethod:t.$_purchaseable_paymentMethod,purchaseResponse:["creditcard","paypay"].includes(t.$_purchaseable_paymentMethod)||["docomo","au","softbank"].includes(t.$_purchaseable_paymentMethod)&&"note_purchase"===t.actionType?t.$store.state.purchase.successed:t.$store.state.purchase.successed.carrierPayment})}))()},$_purchaseable_openPurchaseNoteModal(e){var t=arguments,r=this;return Object(n.a)((function*(){var n=t.length>1&&void 0!==t[1]?t[1]:"";yield r.$store.dispatch(c.PURCHASE_ACTION_TYPES.SET_NOTE,e),r.isLoggedIn?r.currentUser.emailConfirmedFlag?r.$_purchaseable_moveToFirstPurchasePageFromCustomDomain({actionType:"note_purchase",content:e,scrollpos:n}):r.pushRequestEmailConfirmModal():r.pushLoginOrSignupModal({type:"note",note:e})}))()},$_purchaseable_openPurchaseMagazineModal(e){var t=this;return Object(n.a)((function*(){t.isLoggedIn?t.currentUser.emailConfirmedFlag?(t.$store.dispatch(c.PURCHASE_ACTION_TYPES.SET_MAGAZINE,e),t.$_purchaseable_moveToFirstPurchasePageFromCustomDomain({actionType:"magazine_purchase",content:e})):t.pushRequestEmailConfirmModal():t.pushLoginOrSignupModal({type:"magazine"})}))()},$_purchaseable_openPurchaseSupportModal(e){var t=this;return Object(n.a)((function*(){t.isLoggedIn?t.currentUser.emailConfirmedFlag?t.currentUser.id!==e.user.id?(t.$store.dispatch(c.PURCHASE_ACTION_TYPES.SET_NOTE,e),t.$_purchaseable_moveToFirstPurchasePageFromCustomDomain({actionType:"support",content:e})):t.pushBasicMessageModal({actionType:"support_myself"}):t.pushRequestEmailConfirmModal():t.pushLoginOrSignupModal({type:"support"})}))()},$_purchaseable_openPurchaseSubscribeMagazine(e,t,r){var o=this;return Object(n.a)((function*(){o.isLoggedIn?o.currentUser.emailConfirmedFlag?(o.$store.dispatch(c.PURCHASE_ACTION_TYPES.SET_CONVERSION_INFORMATION,{conversionKind:t,conversionContentId:r}),o.$store.dispatch(c.PURCHASE_ACTION_TYPES.SET_MAGAZINE,e),o.$_purchaseable_moveToFirstPurchasePageFromCustomDomain({actionType:"magazine_subscribe",content:e,conversionKind:t,conversionContentId:r})):o.pushRequestEmailConfirmModal():o.pushLoginOrSignupModal({type:"magazine_subscribe"})}))()},$_purchaseable_openPurchaseSubscribePremium(e){var t=this;return Object(n.a)((function*(){t.isLoggedIn?t.currentUser.emailConfirmedFlag?t.replacePurchaseSubscribePremiumModal(e):t.pushRequestEmailConfirmModal():t.pushLoginOrSignupModal({type:"premium_subscribe"})}))()},$_purchaseable_moveToFirstPurchasePageFromCustomDomain(e){var{actionType:t,content:content,conversionKind:r,conversionContentId:n,scrollpos:o}=e;try{var c;switch(t){case"note_purchase":c="/a/purchase/oneshot?scrollpos=".concat(o);break;case"magazine_purchase":c="/a/purchase/oneshot";break;case"magazine_subscribe":c="/a/purchase/subscribe_magazine";break;case"support":c="/a/purchase/support";break;default:c="/"}var d=new URL(c,this.$path.currentNoteBaseUrl||"");d.searchParams.set("k",content.key),d.searchParams.set("at",t),r&&n&&(d.searchParams.set("conversion_kind",r),d.searchParams.set("conversion_content_id",String(n))),location.href=d.href}catch(e){this.pushAnyMessageModal({message:"エラーが発生しました。お手数ですが再度お試しください。"})}}})};t.a=_},1805:function(e,t,r){"use strict";r.d(t,"b",(function(){return c})),r.d(t,"c",(function(){return l})),r.d(t,"a",(function(){return P}));var n=r(0),o=r(161);function c(e){return d.apply(this,arguments)}function d(){return(d=Object(n.a)((function*(e){return(yield e.get("/v2/current_user/email")).data.data.email}))).apply(this,arguments)}function l(e,t){return h.apply(this,arguments)}function h(){return(h=Object(n.a)((function*(e,t){return"twitter"===t?_(e):"google_oauth2"===t?v(e):"apple"===t&&y(e)}))).apply(this,arguments)}function _(e){return m.apply(this,arguments)}function m(){return(m=Object(n.a)((function*(e){return(yield e.get("/v2/current_user/twitter_integration_acknowledgement")).data.data.twitter_integration_acknowledgement}))).apply(this,arguments)}function v(e){return f.apply(this,arguments)}function f(){return(f=Object(n.a)((function*(e){return(yield e.get("/v2/current_user/google_integration_acknowledgement")).data.data.google_integration_acknowledgement}))).apply(this,arguments)}function y(e){return $.apply(this,arguments)}function $(){return($=Object(n.a)((function*(e){return(yield e.get("/v2/current_user/apple_integration_acknowledgement")).data.data.apple_integration_acknowledgement}))).apply(this,arguments)}function C(e){return M.apply(this,arguments)}function M(){return(M=Object(n.a)((function*(e){return(yield e.get("/v2/current_user/interested_categories")).data.data}))).apply(this,arguments)}function P(e,t){return T.apply(this,arguments)}function T(){return(T=Object(n.a)((function*(e,t){return yield Object(o.b)("interested-categories",3024e5,Object(n.a)((function*(){var data=yield C(e);return{[t.id]:data}})),(data=>Boolean(data[t.id])))}))).apply(this,arguments)}},3078:function(e,t,r){"use strict";r.d(t,"b",(function(){return c})),r.d(t,"a",(function(){return d}));var n=r(98),o=r(9),c=e=>{!window.aerosmith&&e&&Object(n.f)(o.asuka.scoringScript,!1,(script=>{script.onload=()=>{Object.defineProperty(window,"aerosmith",{writable:!1,value:Object.freeze(window.aerosmith)}),window.aerosmith.init()}}))},d=(e,t,r)=>{window.aerosmith&&r?window.aerosmith.checkScore((r=>{switch(r){case"LRT":case"BIAT":case"MM":e();break;default:t()}}),t):e()}},3079:function(e,t,r){var content=r(3933);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,r(13).default)("04c15e6a",content,!0,{sourceMap:!1})},3612:function(e,t,r){"use strict";var n=r(0),o=(r(24),r(369),r(32),r(68),r(3)),c=r(53),d=r(80),l=r(193),h=r(114),_=r(358),m=r(25),v=r(189),f=r(47),y=r(365),$=r(101),C=r(1805),M=r(38),P=o.a.extend({components:{FormErrorList:d.a,FormGroup:l.a,FormInput:h.a,FormSelect:_.a,NtImage:m.a,NtLink:f.a,NtInput:v.a},props:{card:{type:Object,required:!0},price:{type:Number,default:0},contentName:{type:String,default:""},categories:{type:Array,default:()=>[]}},data:()=>({isComposing:!1,splitCardNo:"",email:null}),computed:{noSplitCardNo(){return this.card.no.replace(/-/g,"")},selectableYears:()=>Array.from({length:11},((e,i)=>({id:i+Object(y.a)(),value:i+Object(y.a)()}))),selectableMonths:()=>Array.from({length:12},((e,i)=>({id:(i+1).toString().padStart(2,"0"),value:(i+1).toString().padStart(2,"0")}))),customDomain(){return this.$store.getters[M.METADATA_GETTER_TYPES.CUSTOM_DOMAIN]},registeredAt(){return Object(y.b)(this.currentUser.registeredAt,"YYYYMMDDHHmm")},isPurchase(){return 0!==this.price&&""!==this.contentName},asContentName(){return 0===this.categories.length?this.contentName:this.categories.concat(this.contentName).join("_")},asExpirationDate(){var e=new Date(this.card.expiryYear,this.card.expiryMonth-1);return Object(y.b)(e,"MMYY")}},mounted(){var e=this;return Object(n.a)((function*(){e.isLoggedIn&&!e.customDomain&&(e.loading=!0,e.email=yield Object(C.b)(e.$axios),e.loading=!1)}))()},validations:()=>({card:{no:{required:c.required,length:e=>14<=(e=e.replace(/-/g,"")).length&&e.length<=16,pattern:e=>(e=e.replace(/-/g,""),RegExp("^[0-9]+$").test(e))},cvc:{required:c.required,length:e=>3<=e.length&&e.length<=4},name:{required:c.required,pattern:e=>RegExp("^[A-Z.,-/ ]+$").test(e)}}}),methods:{compositionstart(){this.isComposing=!0},compositionend(){this.isComposing=!1,this.updateCardNo(this.card.no)},updateCardNo(e){var t=this.card.no.length<=e.length&&!this.isComposing;this.card.no=e,this.splitCardNo=t?Object($.c)(this.noSplitCardNo):this.card.no}}}),T=(r(3932),r(5)),component=Object(T.a)(P,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("div",{staticClass:"m-creditCardForm__item"},[r("nt-image",{staticClass:"m-creditCardForm__cardimage",attrs:{src:e.$path.assetsPath("images/fig_cardlist.png"),lazy:!1,alt:"対応カードブランド Visa アメリカン・エキスプレス Mastercard JCB ダイナーズクラブ"}})],1),e._v(" "),r("div",{staticClass:"m-creditCardForm__item"},[r("form-input",{attrs:{id:"no",value:e.splitCardNo,required:!0,"has-error":e.$v.card.no.$error,type:"text",label:"カード番号",placeholder:"例: 1111-2222-3333-4444"},on:{compositionstart:e.compositionstart,compositionend:e.compositionend,input:e.updateCardNo,blur:function(t){return e.$v.card.no.$touch()}}},[e.$v.card.no.$error?r("form-error-list",{attrs:{slot:"errorMessage"},slot:"errorMessage"},[e.$v.card.no.required?e._e():r("div",[e._v("\n          カード番号は入力必須です。\n        ")]),e._v(" "),e.$v.card.no.length?e._e():r("div",[e._v("\n          カード番号は14桁から16桁で入力してください。\n        ")]),e._v(" "),e.$v.card.no.pattern?e._e():r("div",[e._v("\n          カード番号は数字のみで入力してください\n        ")])]):e._e()],1)],1),e._v(" "),r("div",{staticClass:"m-creditCardForm__item"},[r("form-input",{attrs:{id:"bin",value:e.noSplitCardNo,type:"hidden"}})],1),e._v(" "),r("div",{staticClass:"m-creditCardForm__item"},[r("form-input",{attrs:{id:"name",required:!0,"has-error":e.$v.card.name.$error,type:"text",label:"カード名義",placeholder:"例: TARO NOTE",name:"as-card-name"},on:{blur:function(t){return e.$v.card.name.$touch()}},model:{value:e.card.name,callback:function(t){e.$set(e.card,"name",t)},expression:"card.name"}},[e.$v.card.name.$error?r("form-error-list",{attrs:{slot:"errorMessage"},slot:"errorMessage"},[e.$v.card.name.required?e._e():r("div",[e._v("\n          カード名義は入力必須です。\n        ")]),e._v(" "),e.$v.card.name.pattern?e._e():r("div",[e._v("\n          半角英大文字で入力してください。\n        ")])]):e._e()],1)],1),e._v(" "),r("div",{staticClass:"m-creditCardForm__item"},[r("form-group",{attrs:{required:!0,label:"有効期限"}},[r("div",{staticClass:"m-creditCardForm__limit"},[r("span",{staticClass:"visually-hidden",attrs:{id:"expiryMonth"}},[e._v("\n          月\n        ")]),e._v(" "),r("form-select",{attrs:{id:"month",labelledby:"expiryMonth",options:e.selectableMonths},model:{value:e.card.expiryMonth,callback:function(t){e.$set(e.card,"expiryMonth",t)},expression:"card.expiryMonth"}}),e._v(" "),r("div",{staticClass:"m-creditCardForm__limitSeparate"},[e._v("\n          /\n        ")]),e._v(" "),r("div",[r("span",{staticClass:"visually-hidden",attrs:{id:"expiryYear"}},[e._v("\n            年\n          ")]),e._v(" "),r("form-select",{attrs:{id:"year",labelledby:"expiryYear",options:e.selectableYears},model:{value:e.card.expiryYear,callback:function(t){e.$set(e.card,"expiryYear",t)},expression:"card.expiryYear"}})],1)],1)])],1),e._v(" "),r("div",{staticClass:"m-creditCardForm__item m-creditCardForm__item--security"},[r("form-input",{attrs:{id:"cvc",required:!0,"has-error":e.$v.card.cvc.$error,type:"number",label:"セキュリティコード",placeholder:"例: 123",width:"4length"},on:{blur:function(t){return e.$v.card.cvc.$touch()}},model:{value:e.card.cvc,callback:function(t){e.$set(e.card,"cvc",t)},expression:"card.cvc"}},[r("nt-image",{staticClass:"m-creditCardForm__securityImage",attrs:{slot:"item",src:e.$path.assetsPath("images/fig_cardsecrity.png"),lazy:!1,alt:"カード裏面の数字"},slot:"item"}),e._v(" "),e.$v.card.cvc.$error?r("form-error-list",{attrs:{slot:"errorMessage"},slot:"errorMessage"},[e.$v.card.cvc.required?e._e():r("div",[e._v("\n          セキュリティコードは入力必須です。\n        ")]),e._v(" "),e.$v.card.cvc.length?e._e():r("div",[e._v("\n          セキュリティコードは3桁から4桁で入力してください。\n        ")])]):e._e()],1)],1),e._v(" "),e.isLoggedIn?r("form-input",{attrs:{id:"mail",type:"hidden",value:e.email}}):e._e(),e._v(" "),e.isLoggedIn?r("form-input",{attrs:{id:"as-user-entry-date",type:"hidden",value:e.registeredAt}}):e._e(),e._v(" "),e.isPurchase?r("form-input",{attrs:{id:"as-price",type:"hidden",value:e.price}}):e._e(),e._v(" "),e.isPurchase?r("nt-input",{staticClass:"as-content-name",attrs:{type:"hidden",value:e.asContentName}}):e._e(),e._v(" "),r("nt-input",{attrs:{id:"as-expiration-date",type:"hidden",value:e.asExpirationDate}}),e._v(" "),r("div",{staticClass:"m-creditCardForm__note"},[e._v("\n    クレジットカード情報の取り扱いについては 「"),r("nt-link",{staticClass:"m-creditCardForm__noteLink",attrs:{href:"https://help-note.com/hc/ja/articles/360011270654",target:"_blank"}},[e._v("\n      課金情報の取り扱いの安全性について\n    ")]),e._v("」をごらんください。\n  ")],1)],1)}),[],!1,null,"79fcdeed",null);t.a=component.exports},3932:function(e,t,r){"use strict";r(3079)},3933:function(e,t,r){var n=r(12)((function(i){return i[1]}));n.push([e.i,".m-creditCardForm__item+.m-creditCardForm__item[data-v-79fcdeed]{margin-top:24px}.m-creditCardForm__item--security[data-v-79fcdeed]{display:flex}.m-creditCardForm__cardimage[data-v-79fcdeed]{display:block;width:260px;max-width:100%;max-height:34px;margin:24px auto}.m-creditCardForm__limit[data-v-79fcdeed]{display:flex;align-items:center}.m-creditCardForm__limitSeparate[data-v-79fcdeed]{display:flex;align-items:center;margin-right:16px;margin-left:16px}.m-creditCardForm__securityImage[data-v-79fcdeed]{height:40px;margin-left:8px}.m-creditCardForm__note[data-v-79fcdeed]{margin-top:24px;font-size:var(--font-size-sm);color:var(--color-text-secondary)}.m-creditCardForm__noteLink[data-v-79fcdeed]{color:var(--color-custom-accent)}",""]),n.locals={},e.exports=n}}]);